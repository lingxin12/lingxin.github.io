<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#ECB3FF"><meta name="author" content="lingxin"><meta name="copyright" content="lingxin"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>æ¨¡æ¿ | Lingxin</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false},
      {left: "\\[", right: "\\]", display: true}
    ]
  });
});</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#ECB3FF"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"lingxin12.github.io.git","root":"/","title":["ling","xin","ã®","blog"],"version":"1.5.2","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["255, 133, 102","255, 201, 77","255, 92, 51"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Lingxin" type="application/atom+xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js" defer></script><script src="/js/load-aplayer.js" defer></script><meta name="description" content="ï¼ˆå›¾ç‰‡æ¥è‡ªhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;moon_sky1999&#x2F;article&#x2F;details&#x2F;82148149ï¼‰ ä»£ç æ¨¡æ¿#include&lt;bits&#x2F;stdc++.h&gt; &#x2F;* #include&lt;iostream&gt; #include&lt;cstdio&gt; #include&lt;cstring&gt; #include&lt;algorithm&gt; #include&lt;b">
<meta property="og:type" content="article">
<meta property="og:title" content="æ¨¡æ¿">
<meta property="og:url" content="https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/index.html">
<meta property="og:site_name" content="Lingxin">
<meta property="og:description" content="ï¼ˆå›¾ç‰‡æ¥è‡ªhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;moon_sky1999&#x2F;article&#x2F;details&#x2F;82148149ï¼‰ ä»£ç æ¨¡æ¿#include&lt;bits&#x2F;stdc++.h&gt; &#x2F;* #include&lt;iostream&gt; #include&lt;cstdio&gt; #include&lt;cstring&gt; #include&lt;algorithm&gt; #include&lt;b">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/1.png">
<meta property="article:published_time" content="2021-03-21T02:57:10.000Z">
<meta property="article:modified_time" content="2021-05-25T15:04:35.012Z">
<meta property="article:author" content="lingxin">
<meta property="article:tag" content="ç®—æ³•">
<meta property="article:tag" content="ACM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/1.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="lingxin"><img width="96" loading="lazy" src="/headimg.ico" alt="lingxin"><span class="site-author-status" title="å¥½å¥½å­¦ä¹ ï¼å¥½å¥½å­¦ä¹ ï¼å¥½å¥½å­¦ä¹ ï¼">ğŸ˜œ</span></a><div class="site-author-name"><a href="/about/">lingxin</a></div><span class="site-name">Lingxin</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">33</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">20</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">25</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/lingxin12/lingxin12.github.io" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1693662418@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/ling-san-jin-84" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/242207729" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.</span> <span class="toc-text">ä»£ç æ¨¡æ¿</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">åŸºç¡€ç®—æ³•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2"><span class="toc-number">3.</span> <span class="toc-text">æœç´¢</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95"><span class="toc-number">4.</span> <span class="toc-text">è®¡ç®—å‡ ä½•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.1.</span> <span class="toc-text">åŸºç¡€æ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.1.1.</span> <span class="toc-text">è®¡ç®—å‡ ä½•æ¨¡æ¿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9"><span class="toc-number">4.2.</span> <span class="toc-text">è¿›é˜¶å†…å®¹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6"><span class="toc-number">5.</span> <span class="toc-text">æ•°å­¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA"><span class="toc-number">5.1.</span> <span class="toc-text">æ•°è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80%EF%BC%8C%E6%AC%A7%E5%87%A0%E5%9F%83%E6%B0%8F%E7%AD%9B%E6%89%A9%E6%AC%A7%E5%8F%96%E6%A8%A1%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-number">5.1.1.</span> <span class="toc-text">æ•°è®ºåŸºç¡€ï¼Œæ¬§å‡ åŸƒæ°ç­›æ‰©æ¬§å–æ¨¡å¿«é€Ÿå¹‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%86%E5%85%83%E5%8F%8A%E9%80%86%E5%85%83%E6%B1%82%E6%B3%95"><span class="toc-number">5.1.2.</span> <span class="toc-text">é€†å…ƒåŠé€†å…ƒæ±‚æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.3.</span> <span class="toc-text">æ¬§æ‹‰å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B%E5%92%8C%E4%BA%8C%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-number">5.1.4.</span> <span class="toc-text">ä¸€æ¬¡åŒä½™æ–¹ç¨‹å’ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6"><span class="toc-number">5.2.</span> <span class="toc-text">ç»„åˆæ•°å­¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%9A%E5%BC%88%E8%AE%BA"><span class="toc-number">5.3.</span> <span class="toc-text">åšå¼ˆè®º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">6.</span> <span class="toc-text">æ•°æ®ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.</span> <span class="toc-text">åŸºç¡€æ•°æ®ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%B7%AE%E5%88%86%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E6%B1%82%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9%E5%8D%95%E7%82%B9%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">6.1.1.</span> <span class="toc-text">æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%B7%AE%E5%88%86%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E6%B1%82%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">6.1.2.</span> <span class="toc-text">æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2%E5%8D%95%E7%82%B9%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">6.1.3.</span> <span class="toc-text">æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢å•ç‚¹æŸ¥è¯¢ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91%EF%BC%88%E5%8A%A0%E6%B3%95%EF%BC%89"><span class="toc-number">6.1.4.</span> <span class="toc-text">çº¿æ®µæ ‘ï¼ˆåŠ æ³•ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%95%B0%EF%BC%88%E5%8A%A0%E4%B9%98%E6%B3%95%EF%BC%89"><span class="toc-number">6.1.5.</span> <span class="toc-text">çº¿æ®µæ•°ï¼ˆåŠ ä¹˜æ³•ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%B8%AD%E6%A0%91%EF%BC%88%E5%8C%BA%E9%97%B4%E7%AC%ACk%E5%B0%8F%EF%BC%89"><span class="toc-number">6.1.6.</span> <span class="toc-text">ä¸»å¸­æ ‘ï¼ˆåŒºé—´ç¬¬kå°ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP"><span class="toc-number">6.1.7.</span> <span class="toc-text">KMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ac%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="toc-number">6.1.8.</span> <span class="toc-text">acè‡ªåŠ¨æœº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">6.2.</span> <span class="toc-text">é«˜çº§æ•°æ®ç»“æ„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E8%AE%BA"><span class="toc-number">7.</span> <span class="toc-text">å›¾è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">7.1.</span> <span class="toc-text">æœ€çŸ­è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E4%BC%98%E5%8C%96dijkstra"><span class="toc-number">7.1.1.</span> <span class="toc-text">ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–dijkstra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spfa"><span class="toc-number">7.1.2.</span> <span class="toc-text">spfa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#floyd"><span class="toc-number">7.1.3.</span> <span class="toc-text">floyd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCA"><span class="toc-number">7.1.4.</span> <span class="toc-text">LCA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="toc-number">7.1.5.</span> <span class="toc-text">å¼ºè¿é€šåˆ†é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E5%89%B2%E7%82%B9%E4%B8%8E%E6%A1%A5"><span class="toc-number">7.1.6.</span> <span class="toc-text">å›¾çš„å‰²ç‚¹ä¸æ¡¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE"><span class="toc-number">7.2.</span> <span class="toc-text">äºŒåˆ†å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9C%80%E5%A4%A7%E5%8C%B9%E9%85%8D%EF%BC%88%E5%8C%88%E7%89%99%E5%88%A9%EF%BC%89"><span class="toc-number">7.2.1.</span> <span class="toc-text">äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%B5%81"><span class="toc-number">7.3.</span> <span class="toc-text">ç½‘ç»œæµ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%B5%81%E6%9C%80%E5%A4%A7%E6%B5%81%EF%BC%88%E4%BC%98%E5%8C%96dinic%EF%BC%89"><span class="toc-number">7.3.1.</span> <span class="toc-text">ç½‘ç»œæµæœ€å¤§æµï¼ˆä¼˜åŒ–dinicï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E8%B4%B9%E7%94%A8%E6%9C%80%E5%A4%A7%E6%B5%81"><span class="toc-number">7.3.2.</span> <span class="toc-text">æœ€å°è´¹ç”¨æœ€å¤§æµ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"><span class="toc-number">8.</span> <span class="toc-text">åŠ¨æ€è§„åˆ’</span></a></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/ACM/" style="font-size: 27px; color: #fbd966">ACM</a> <a href="/tags/CCPC/" style="font-size: 12px; color: #e65c00">CCPC</a> <a href="/tags/VPN/" style="font-size: 12px; color: #e65c00">VPN</a> <a href="/tags/codeforces/" style="font-size: 18px; color: #ee8e29">codeforces</a> <a href="/tags/vscode/" style="font-size: 12px; color: #e65c00">vscode</a> <a href="/tags/%E4%BA%8C%E5%88%86/" style="font-size: 12px; color: #e65c00">äºŒåˆ†</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 12px; color: #e65c00">ä»£ç†</a> <a href="/tags/%E5%85%AC%E5%BC%8F/" style="font-size: 12px; color: #e65c00">å…¬å¼</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 12px; color: #e65c00">åŠ¨æ€è§„åˆ’</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%9B%BE%E7%89%87%E6%98%BE%E7%A4%BA/" style="font-size: 12px; color: #e65c00">åšå®¢å›¾ç‰‡æ˜¾ç¤º</a> <a href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" style="font-size: 12px; color: #e65c00">åšå¼ˆè®º</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 21px; color: #f3a73d">æ•°å­¦</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 15px; color: #ea7514">æ•°è®º</a> <a href="/tags/%E6%9A%B4%E5%8A%9B/" style="font-size: 12px; color: #e65c00">æš´åŠ›</a> <a href="/tags/%E6%9B%B4%E7%9B%B8%E5%87%8F%E6%8D%9F%E6%9C%AF/" style="font-size: 12px; color: #e65c00">æ›´ç›¸å‡æŸæœ¯</a> <a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size: 12px; color: #e65c00">æšä¸¾</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 30px; color: #fff27a">ç®—æ³•</a> <a href="/tags/%E7%B4%AB%E4%B9%A6/" style="font-size: 18px; color: #ee8e29">ç´«ä¹¦</a> <a href="/tags/%E7%BB%83%E4%B9%A0/" style="font-size: 12px; color: #e65c00">ç»ƒä¹ </a> <a href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" style="font-size: 12px; color: #e65c00">èƒŒåŒ…é—®é¢˜</a> <a href="/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/" style="font-size: 12px; color: #e65c00">è“æ¡¥æ¯</a> <a href="/tags/%E8%AE%AD%E7%BB%83%E8%B5%9B/" style="font-size: 12px; color: #e65c00">è®­ç»ƒèµ›</a> <a href="/tags/%E8%BE%97%E8%BD%AC%E7%9B%B8%E9%99%A4%E6%B3%95/" style="font-size: 12px; color: #e65c00">è¾—è½¬ç›¸é™¤æ³•</a> <a href="/tags/%E9%80%86%E5%85%83/" style="font-size: 12px; color: #e65c00">é€†å…ƒ</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 24px; color: #f7c051">é¢˜è§£</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="lingxin"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Lingxin"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">æ¨¡æ¿</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-21 10:57:10" itemprop="dateCreated datePublished" datetime="2021-03-21T10:57:10+08:00">2021-03-21</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-05-25 23:04:35" itemprop="dateModified" datetime="2021-05-25T23:04:35+08:00">2021-05-25</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E6%A8%A1%E6%9D%BF/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ¨¡æ¿</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/%E7%AE%97%E6%B3%95/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">ç®—æ³•</span></a><a class="tag" href="/tags/ACM/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">ACM</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#ECB3FF;"><p><img src="/2021/03/21/%E6%A8%A1%E6%9D%BF/1.png" alt="1" loading="lazy"></p>
<p>ï¼ˆå›¾ç‰‡æ¥è‡ª<a target="_blank" rel="noopener" href="https://blog.csdn.net/moon_sky1999/article/details/82148149%EF%BC%89">https://blog.csdn.net/moon_sky1999/article/details/82148149ï¼‰</a></p>
<h1 id="ä»£ç æ¨¡æ¿"><a href="#ä»£ç æ¨¡æ¿" class="headerlink" title="ä»£ç æ¨¡æ¿"></a>ä»£ç æ¨¡æ¿</h1><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token comment">/*
#include&lt;iostream>
#include&lt;cstdio>
#include&lt;cstring>
#include&lt;algorithm>
#include&lt;bitset>
#include&lt;cassert>
#include&lt;cctype>
#include&lt;cmath>
#include&lt;cstdlib>
#include&lt;ctime>
#include&lt;deque>
#include&lt;iomanip>
#include&lt;list>
#include&lt;map>
#include&lt;queue>
#include&lt;set>
#include&lt;stack>
#include&lt;vector>
*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">jud cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"caonima"</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pll pair<span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Clear</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>x<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>x<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pqg</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pql</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Max</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token keyword">int</span> T<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//freopen("data.in","r",stdin);</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> T<span class="token punctuation">;</span>
    <span class="token comment">//T = 1;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>T<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="åŸºç¡€ç®—æ³•"><a href="#åŸºç¡€ç®—æ³•" class="headerlink" title="åŸºç¡€ç®—æ³•"></a>åŸºç¡€ç®—æ³•</h1><h1 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h1><h1 id="è®¡ç®—å‡ ä½•"><a href="#è®¡ç®—å‡ ä½•" class="headerlink" title="è®¡ç®—å‡ ä½•"></a>è®¡ç®—å‡ ä½•</h1><h2 id="åŸºç¡€æ¨¡æ¿"><a href="#åŸºç¡€æ¨¡æ¿" class="headerlink" title="åŸºç¡€æ¨¡æ¿"></a>åŸºç¡€æ¨¡æ¿</h2><h3 id="è®¡ç®—å‡ ä½•æ¨¡æ¿"><a href="#è®¡ç®—å‡ ä½•æ¨¡æ¿" class="headerlink" title="è®¡ç®—å‡ ä½•æ¨¡æ¿"></a>è®¡ç®—å‡ ä½•æ¨¡æ¿</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//è®¡ç®—å‡ ä½•åŸºç¡€æ¨¡æ¿ï¼Œè¯¥æ¨¡æ¿æœªå®Œæˆï¼Œå¾…æ›´æ–°</span>
<span class="token comment">//å‚è€ƒhttps://linxi99.gitee.io/20190211/ACM%E5%87%A0%E4%BD%95%E5%9F%BA%E7%A1%80%E7%AF%87/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> pi <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> inf <span class="token operator">=</span> <span class="token number">1e100</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> eps <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">;</span>

<span class="token comment">//ç¬¦å·å‡½æ•°ï¼ŒéªŒè¯å‚æ•°çš„ç¬¦å·</span>
<span class="token keyword">int</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token keyword">double</span> d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æµ®ç‚¹åˆ¤ç­‰å‡½æ•°</span>
<span class="token keyword">int</span> <span class="token function">dcmp</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">></span> y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
    <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> Point Vector<span class="token punctuation">;</span>

<span class="token comment">//å‘é‡åŠ å‡</span>
Vector <span class="token keyword">operator</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">+</span>B<span class="token punctuation">.</span>x<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">+</span>B<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
Vector <span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span>Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">-</span>B<span class="token punctuation">.</span>x<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">-</span>B<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å‘é‡ä¼¸ç¼©</span>
Vector <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span>p<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
Vector <span class="token keyword">operator</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">/</span>p<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">/</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å‘é‡æ¯”è¾ƒ</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>x<span class="token operator">||</span>a<span class="token punctuation">.</span>x<span class="token operator">==</span>b<span class="token punctuation">.</span>x<span class="token operator">&amp;&amp;</span>a<span class="token punctuation">.</span>y<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">></span>b<span class="token punctuation">.</span>x<span class="token operator">||</span>a<span class="token punctuation">.</span>x<span class="token operator">==</span>b<span class="token punctuation">.</span>x<span class="token operator">&amp;&amp;</span>a<span class="token punctuation">.</span>y<span class="token operator">></span>b<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">dcmp</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>b<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">dcmp</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å†…ç§¯è¿ç®—ï¼š1.å†…ç§¯ä¸ºæ­£ä¸ºé”è§’ 2.å†…ç§¯ä¸ºè´Ÿä¸ºé’è§’ 3.å†…ç§¯ä¸º0ä¸ºç›´è§’</span>
<span class="token keyword">double</span> <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span>B<span class="token punctuation">.</span>x <span class="token operator">+</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span>B<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å¤–ç§¯è¿ç®—ï¼šï¼ˆå³æ‰‹å®šåˆ™ï¼‰1.Båœ¨Açš„é€†æ—¶é’ˆæ–¹å‘ä¸ºæ­£å€¼ 2.é¡ºæ—¶é’ˆä¸ºè´Ÿå€¼ 3.å…±çº¿ä¸º0</span>
<span class="token keyword">double</span> <span class="token keyword">operator</span> <span class="token operator">^</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span>B<span class="token punctuation">.</span>y<span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span>B<span class="token punctuation">.</span>x<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token comment">//å–æ¨¡</span>
<span class="token keyword">double</span> <span class="token function">Length</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>A<span class="token operator">*</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//è®¡ç®—ä¸¤å‘é‡å¤¹è§’</span>
<span class="token keyword">double</span> <span class="token function">Angle</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">acos</span><span class="token punctuation">(</span>A<span class="token operator">*</span>B <span class="token operator">/</span> <span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">Length</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//è®¡ç®—ä¸¤å‘é‡æ„æˆçš„å¹³è¡Œå››è¾¹å½¢æœ‰å‘é¢ç§¯</span>
<span class="token keyword">double</span> <span class="token function">Area2</span><span class="token punctuation">(</span>Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">,</span> Point C<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>B<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>C<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//radä¸ºå¼§åº¦ï¼Œä¸”ä¸ºé€†æ—¶é’ˆæ—‹è½¬çš„è§’</span>
Vector <span class="token function">Rotate1</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> rad<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">+</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//radä¸ºå¼§åº¦ï¼Œä¸”ä¸ºé¡ºæ—¶é’ˆæ—‹è½¬çš„è§’</span>
Vector <span class="token function">Rotate2</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> rad<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">+</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">-</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å‘é‡Aå·¦è½¬90Â°çš„å•ä½æ³•å‘é‡</span>
Vector <span class="token function">Normal1</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//å‘é‡Aå³è½¬90Â°çš„å•ä½æ³•å‘é‡</span>
Vector <span class="token function">Normal2</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>y<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span>A<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­æŠ˜çº¿â†’bcæ˜¯ä¸æ˜¯å‘â†’abçš„é€†æ—¶é’ˆæ–¹å‘ï¼ˆå·¦è¾¹ï¼‰è½¬å‘ï¼Œå‡¸åŒ…æ„é€ æ—¶å°†ä¼šé¢‘ç¹ç”¨åˆ°æ­¤å…¬å¼</span>
<span class="token keyword">bool</span> <span class="token function">ToLeftTest</span><span class="token punctuation">(</span>Point a<span class="token punctuation">,</span> Point b<span class="token punctuation">,</span> Point c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
	<span class="token keyword">double</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>c<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> v <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//ç›´çº¿å¯ä»¥ç”¨ç›´çº¿ä¸Šçš„ä¸€ä¸ªç‚¹P0å’Œæ–¹å‘å‘é‡vè¡¨ç¤ºï¼ŒP=P0+vtï¼Œå…¶ä¸­tä¸ºå‚æ•°</span>
<span class="token comment">//ç›´çº¿å®šä¹‰</span>
<span class="token keyword">struct</span> <span class="token class-name">Line</span> <span class="token punctuation">&#123;</span>
    Point v<span class="token punctuation">,</span> p<span class="token punctuation">;</span>
    <span class="token function">Line</span><span class="token punctuation">(</span>Point v<span class="token punctuation">,</span> Point p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">v</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
	<span class="token comment">//è¿”å›ç‚¹P = v + (p - v)*t</span>
    Point <span class="token function">point</span><span class="token punctuation">(</span><span class="token keyword">double</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> v <span class="token operator">+</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> v<span class="token punctuation">)</span><span class="token operator">*</span>t<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//åˆ¤æ–­ç‚¹åœ¨ç›´çº¿ä¸Šï¼Œåˆ©ç”¨ä¸‰ç‚¹å…±çº¿çš„ç­‰ä»·æ¡ä»¶ï¼šå³å‰ç§¯ä¸º0</span>
<span class="token keyword">void</span> <span class="token function">void_cmp</span><span class="token punctuation">(</span>Point a<span class="token punctuation">,</span>Line L<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ä¸¤ç›´çº¿äº¤ç‚¹</span>
<span class="token comment">//è°ƒç”¨å‰éœ€ä¿è¯ v^w != 0</span>
Point <span class="token function">GetLineIntersection</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Vector v<span class="token punctuation">,</span> Point Q<span class="token punctuation">,</span> Vector w<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Vector u <span class="token operator">=</span> P<span class="token operator">-</span>Q<span class="token punctuation">;</span>
    <span class="token keyword">double</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token operator">^</span>u<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>v<span class="token operator">^</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> P<span class="token operator">+</span>v<span class="token operator">*</span>t<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ç‚¹Påˆ°ç›´çº¿ABè·ç¦»å…¬å¼ï¼Œä¸å»ç»å¯¹å€¼ï¼Œå¾—åˆ°çš„æ˜¯æœ‰å‘è·ç¦»</span>
<span class="token keyword">double</span> <span class="token function">DistanceToLine</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Vector v1 <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">,</span> v2 <span class="token operator">=</span> P<span class="token operator">-</span>A<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">fabs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1<span class="token operator">^</span>v2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ç‚¹Påˆ°çº¿æ®µABè·ç¦»å…¬å¼</span>
<span class="token keyword">double</span> <span class="token function">DistanceToSegment</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>A <span class="token operator">==</span> B<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>P<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vector v1 <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">,</span> v2 <span class="token operator">=</span> P<span class="token operator">-</span>A<span class="token punctuation">,</span> v3 <span class="token operator">=</span> P<span class="token operator">-</span>B<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>v1<span class="token operator">*</span>v2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>v1<span class="token operator">*</span>v3<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">DistanceToLine</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ç‚¹Påœ¨ç›´çº¿ABä¸Šçš„æŠ•å½±ç‚¹</span>
Point <span class="token function">GetLineProjection</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Vector v <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">;</span>
    <span class="token keyword">return</span> A<span class="token operator">+</span>v<span class="token operator">*</span><span class="token punctuation">(</span>v<span class="token operator">*</span><span class="token punctuation">(</span>P<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>v<span class="token operator">*</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨çº¿æ®µä¸Š</span>
<span class="token keyword">bool</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>Point p<span class="token punctuation">,</span> Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>a2<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ä¸¤çº¿æ®µæ˜¯å¦ç›¸äº¤ï¼Œä¸å…è®¸åœ¨ç«¯ç‚¹å¤„ç›¸äº¤</span>
<span class="token keyword">bool</span> <span class="token function">SegmentProperIntersection</span><span class="token punctuation">(</span>Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">,</span> Point b1<span class="token punctuation">,</span> Point b2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> c1 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b1 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> c3 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a1 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">,</span> c4 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ä¸¤çº¿æ®µæ˜¯å¦ç›¸äº¤ï¼Œå…è®¸åœ¨ç«¯ç‚¹å¤„ç›¸äº¤</span>
<span class="token keyword">bool</span> <span class="token function">SegmentProperIntersection</span><span class="token punctuation">(</span>Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">,</span> Point b1<span class="token punctuation">,</span> Point b2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> c1 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b1 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> c3 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a1 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">,</span> c4 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//ifåˆ¤æ–­æ§åˆ¶æ˜¯å¦å…è®¸çº¿æ®µåœ¨ç«¯ç‚¹å¤„ç›¸äº¤ï¼Œæ ¹æ®éœ€è¦æ·»åŠ </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">bool</span> f1 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>b1<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f2 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>b2<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f3 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f4 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>a2<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>f1<span class="token operator">|</span>f2<span class="token operator">|</span>f3<span class="token operator">|</span>f4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> f<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ±‚å‡¸å¤šè¾¹å½¢é¢ç§¯ï¼Œpä¸ºç«¯ç‚¹é›†åˆï¼Œnä¸ºç«¯ç‚¹ä¸ªæ•°</span>
<span class="token keyword">double</span> <span class="token function">PolygonArea</span><span class="token punctuation">(</span>Point<span class="token operator">*</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        s <span class="token operator">+=</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼Œè‹¥ç‚¹åœ¨å¤šè¾¹å½¢å†…è¿”å›1ï¼Œåœ¨å¤šè¾¹å½¢å¤–éƒ¨è¿”å›0ï¼Œåœ¨å¤šè¾¹å½¢ä¸Šè¿”å›-1</span>
<span class="token keyword">int</span> <span class="token function">isPointInPolygon</span><span class="token punctuation">(</span>Point p<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>Point<span class="token operator">></span> poly<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> wn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> poly<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">OnSegment</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span> <span class="token operator">-</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>p <span class="token operator">-</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d1 <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d2 <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d1 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d2 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> wn<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d2 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d1 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> wn<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>wn <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//åˆ¤æ–­ç‚¹åœ¨å‡¸å¤šè¾¹å½¢å†…ï¼Œåªéœ€è¦åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨æ‰€æœ‰è¾¹çš„å·¦è¾¹ï¼ˆæŒ‰é€†æ—¶é’ˆé¡ºåºæ’åˆ—çš„é¡¶ç‚¹é›†ï¼‰ToLeftTest</span>
<span class="token keyword">int</span> <span class="token function">void_isXXXXXX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>


<span class="token comment">//åœ†çš„å®šä¹‰</span>
<span class="token keyword">struct</span> <span class="token class-name">Circle</span><span class="token punctuation">&#123;</span>
    Point c<span class="token punctuation">;</span>
    <span class="token keyword">double</span> r<span class="token punctuation">;</span>
    <span class="token function">Circle</span><span class="token punctuation">(</span>Point c<span class="token punctuation">,</span> <span class="token keyword">double</span> r<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">c</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    Point <span class="token function">point</span><span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//é€šè¿‡åœ†å¿ƒè§’æ±‚åæ ‡</span>
        <span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">,</span> c<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token function">sin</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//æ±‚åœ†ä¸ç›´çº¿äº¤ç‚¹</span>
<span class="token keyword">int</span> <span class="token function">getLineCircleIntersection</span><span class="token punctuation">(</span>Line L<span class="token punctuation">,</span> Circle C<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> t1<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> t2<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>Point<span class="token operator">></span><span class="token operator">&amp;</span> sol<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> a <span class="token operator">=</span> L<span class="token punctuation">.</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b <span class="token operator">=</span> L<span class="token punctuation">.</span>p<span class="token punctuation">.</span>x <span class="token operator">-</span> C<span class="token punctuation">.</span>c<span class="token punctuation">.</span>x<span class="token punctuation">,</span> c <span class="token operator">=</span> L<span class="token punctuation">.</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> d <span class="token operator">=</span> L<span class="token punctuation">.</span>p<span class="token punctuation">.</span>y <span class="token operator">-</span> C<span class="token punctuation">.</span>c<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token keyword">double</span> e <span class="token operator">=</span> a<span class="token operator">*</span>a <span class="token operator">+</span> c<span class="token operator">*</span>c<span class="token punctuation">,</span> f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">*</span>b <span class="token operator">+</span> c<span class="token operator">*</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> g <span class="token operator">=</span> b<span class="token operator">*</span>b <span class="token operator">+</span> d<span class="token operator">*</span>d <span class="token operator">-</span> C<span class="token punctuation">.</span>r<span class="token operator">*</span>C<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
    <span class="token keyword">double</span> delta <span class="token operator">=</span> f<span class="token operator">*</span>f <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>e<span class="token operator">*</span>g<span class="token punctuation">;</span><span class="token comment">//åˆ¤åˆ«å¼</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//ç›¸ç¦»</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç›¸åˆ‡</span>
        t1 <span class="token operator">=</span> <span class="token operator">-</span>f <span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2 <span class="token operator">=</span> <span class="token operator">-</span>f <span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//solå­˜æ”¾äº¤ç‚¹æœ¬èº«</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//ç›¸äº¤</span>
    t1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>f <span class="token operator">-</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>f <span class="token operator">+</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ä¸¤åœ†ç›¸äº¤é¢ç§¯ï¼šé€šè¿‡è®¡ç®—ä¸¤ä¸ªåœ†ç›¸äº¤æ‰€æ„æˆçš„ä¸¤ä¸ªæ‰‡å½¢é¢ç§¯å’Œå‡å»å…¶æ„æˆçš„ç­å½¢çš„é¢ç§¯</span>
<span class="token keyword">double</span> <span class="token function">AreaOfOverlap</span><span class="token punctuation">(</span>Point c1<span class="token punctuation">,</span> <span class="token keyword">double</span> r1<span class="token punctuation">,</span> Point c2<span class="token punctuation">,</span> <span class="token keyword">double</span> r2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">Length</span><span class="token punctuation">(</span>c1 <span class="token operator">-</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r1 <span class="token operator">+</span> r2 <span class="token operator">&lt;</span> d <span class="token operator">+</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">&lt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>r1 <span class="token operator">-</span> r2<span class="token punctuation">)</span> <span class="token operator">+</span> eps<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pi<span class="token operator">*</span>r<span class="token operator">*</span>r<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token operator">*</span>d <span class="token operator">+</span> r1<span class="token operator">*</span>r1 <span class="token operator">-</span> r2<span class="token operator">*</span>r2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token operator">*</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>r1 <span class="token operator">+</span> r2 <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> t1 <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>x<span class="token operator">/</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> t2 <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> s1 <span class="token operator">=</span> r1<span class="token operator">*</span>r1<span class="token operator">*</span>t1<span class="token punctuation">;</span>
    <span class="token keyword">double</span> s2 <span class="token operator">=</span> r2<span class="token operator">*</span>r2<span class="token operator">*</span>t2<span class="token punctuation">;</span>
    <span class="token keyword">double</span> s3 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> r1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> r2<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s1 <span class="token operator">+</span> s2 <span class="token operator">-</span> s3<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">1.49999</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fx <span class="token operator">=</span> <span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘ä¸‹å–æ•´å‡½æ•°</span>
    <span class="token keyword">int</span> cx <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘ä¸Šå–æ•´å‡½æ•°</span>
    <span class="token keyword">int</span> rx <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å››èˆäº”å…¥å‡½æ•°</span>

	<span class="token comment">//è¾“å‡ºè¦å°å¿ƒé¿å…è¾“å‡º-0ï¼Œæ¯”å¦‚ï¼šdouble a = -0.000001,printf("%.4f",a);</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%f %d %d %d\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> fx<span class="token punctuation">,</span> cx<span class="token punctuation">,</span> rx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è¾“å‡ºç»“æœ 1.499990 1 2 1</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*

ä½¿ç”¨åä¸‰è§’å‡½æ•°ä¸€å®šè¦æ³¨æ„èŒƒå›´
double x = 1.000001;
double acx = acos(x);
//å¯èƒ½ä¼šè¿”å›runtime error

//æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åŠ ä¸€å¥åˆ¤æ–­
double x = 1.000001;
if(fabs(x - 1.0) &lt; eps || fabs(x + 1.0) &lt; eps)
    x = round(x);
double acx = acos(x);

*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="è¿›é˜¶å†…å®¹"><a href="#è¿›é˜¶å†…å®¹" class="headerlink" title="è¿›é˜¶å†…å®¹"></a>è¿›é˜¶å†…å®¹</h2><h1 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h1><h2 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h2><h3 id="æ•°è®ºåŸºç¡€ï¼Œæ¬§å‡ åŸƒæ°ç­›æ‰©æ¬§å–æ¨¡å¿«é€Ÿå¹‚"><a href="#æ•°è®ºåŸºç¡€ï¼Œæ¬§å‡ åŸƒæ°ç­›æ‰©æ¬§å–æ¨¡å¿«é€Ÿå¹‚" class="headerlink" title="æ•°è®ºåŸºç¡€ï¼Œæ¬§å‡ åŸƒæ°ç­›æ‰©æ¬§å–æ¨¡å¿«é€Ÿå¹‚"></a>æ•°è®ºåŸºç¡€ï¼Œæ¬§å‡ åŸƒæ°ç­›æ‰©æ¬§å–æ¨¡å¿«é€Ÿå¹‚</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">20003</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a<span class="token operator">%</span>b<span class="token operator">?</span><span class="token function">gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token operator">%</span>b<span class="token punctuation">)</span><span class="token operator">:</span>b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  <span class="token comment">//a>b</span>
<span class="token keyword">int</span> <span class="token function">lcm</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a<span class="token operator">/</span><span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  <span class="token comment">//a>b</span>

<span class="token comment">//æ›´ç›¸å‡æŸæœ¯ï¼ˆsteinç®—æ³•ï¼‰</span>
<span class="token keyword">int</span> <span class="token function">stein</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">-</span>b<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//åŸƒæ°ç­›ï¼Œç”Ÿæˆnä»¥å†…çš„æ‰€æœ‰ç´ æ•°ï¼Œå¤æ‚åº¦O(nlognlogn)</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> prim<span class="token punctuation">;</span>
<span class="token keyword">int</span> vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">create_prim</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">+=</span>i<span class="token punctuation">)</span> vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ¬§æ‹‰ç­›ï¼Œå¤æ‚åº¦O(n)</span>
<span class="token keyword">void</span> <span class="token function">_create_prim</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> prim<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			vis<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//æ‰©æ¬§ï¼Œæ±‚ax+by=dï¼Œå…¶ä¸­d=gcd(a,b)çš„æ•´æ•°è§£</span>
<span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> y<span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>

<span class="token comment">//å–æ¨¡å¿«é€Ÿå¹‚</span>
<span class="token keyword">int</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">;</span>
        b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//ax=b(modn) => n|ax-b => b=ax-nyï¼Œç”¨æ‰©æ¬§æ±‚</span>
<span class="token comment">//æ³¨æ„ax=1(modn)ï¼Œaä¸xäº’é€†ï¼Œæ­¤æ—¶è‹¥gcd(a,n)=1æ‰æœ‰è§£</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="é€†å…ƒåŠé€†å…ƒæ±‚æ³•"><a href="#é€†å…ƒåŠé€†å…ƒæ±‚æ³•" class="headerlink" title="é€†å…ƒåŠé€†å…ƒæ±‚æ³•"></a>é€†å…ƒåŠé€†å…ƒæ±‚æ³•</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//ax=1(mod p) ç§°aå…³äºpçš„é€†å…ƒä¸ºx</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//1.å½“pä¸ºç´ æ•°æ—¶å¯ä»¥ç”¨è´¹é©¬å°å®šç†</span>
<span class="token keyword">int</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">inv1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">fastpow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">//aå…³äºpçš„é€†å…ƒ</span>

<span class="token comment">//2.pè‹¥ä¸æ˜¯è´¨æ•°å¯ä»¥ç”¨æ‰©æ¬§</span>
<span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> y<span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">inv2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span>  <span class="token comment">//å¦‚æœä¸å­˜åœ¨è¿”å›-1</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
    <span class="token function">ex_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token punctuation">,</span>d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> d <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token punctuation">(</span>x<span class="token operator">%</span>p <span class="token operator">+</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//xå¯èƒ½ä¸ºè´Ÿæ•°</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//3.å½“pä¸ºè´¨æ•°çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨O(n)çš„æ—¶é—´å†…æ±‚å¤šä¸ªæ•°å…³äºpçš„é€†å…ƒ</span>
<span class="token keyword">int</span> <span class="token function">inv3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token comment">//æ±‚ä¸€ä¸ªæ•°çš„é€†å…ƒæ—¶</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> p<span class="token operator">/</span>a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">inv3</span><span class="token punctuation">(</span>p<span class="token operator">%</span>a <span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">%</span>p <span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> ainv<span class="token punctuation">[</span><span class="token number">3003</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">ex_inv</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ainv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        ainv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> p<span class="token operator">/</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> ainv<span class="token punctuation">[</span>p<span class="token operator">%</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token function">ex_inv</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ok <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">*</span>ainv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">%</span>p <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span>ok<span class="token operator">?</span><span class="token string">"YES"</span><span class="token operator">:</span><span class="token string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> phi<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> prim<span class="token punctuation">;</span>

<span class="token comment">//åœ¨O(sqrt(n))ä¸‹æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°å€¼</span>
<span class="token keyword">int</span> <span class="token function">Phi</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> res <span class="token operator">=</span> n<span class="token punctuation">,</span> a <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">*</span>i<span class="token operator">&lt;=</span>a<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			res<span class="token operator">=</span>res<span class="token operator">/</span>i<span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é˜²æº¢å‡º</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> a<span class="token operator">/=</span>i<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span> res<span class="token operator">=</span>res<span class="token operator">/</span>a<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å‰©ä¸‹çš„é™¤ä¸å®Œçš„aå¿…ä¸ºè´¨æ•°</span>
	<span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ¬§æ‹‰ç­›æ”¹ï¼Œåœ¨O(n)ä¸‹é€’æ¨æ±‚æ¬§æ‹‰å‡½æ•°å€¼ï¼ŒåŒæ—¶ç­›å‡ºè´¨æ•°</span>
<span class="token keyword">void</span> <span class="token function">Get_Phi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	phi<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>maxn<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			prim<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>maxn<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
				phi<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			<span class="token keyword">else</span> phi<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> phi<span class="token punctuation">[</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//å¦‚æœç­›å‡ºäº†nä»¥å†…çš„æ¬§æ‹‰å‡½æ•°å€¼ï¼Œå¯¹äºå¤§äºnçš„æ¬§æ‹‰å‡½æ•°å€¼ï¼Œå¯ä»¥ç”¨æ€§è´¨ç¼©å°è‡³[1,n]å†…æ±‚è§£</span>
<span class="token keyword">int</span> <span class="token function">_Phi</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> maxn<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token operator">*</span>phi<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			n<span class="token operator">/=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> res<span class="token operator">*=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
				res<span class="token operator">*=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span><span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿™é‡Œè¯´æ˜nå·²ç»ä¸ºè´¨æ•°äº†</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹å’ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹"><a href="#ä¸€æ¬¡åŒä½™æ–¹ç¨‹å’ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹" class="headerlink" title="ä¸€æ¬¡åŒä½™æ–¹ç¨‹å’ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹"></a>ä¸€æ¬¡åŒä½™æ–¹ç¨‹å’ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//ä¸€æ¬¡åŒä½™æ–¹ç¨‹ï¼ŒäºŒæ¬¡åŒä½™æ–¹ç¨‹ï¼ˆäºŒæ¬¡å‰©ä½™ï¼‰çš„æ±‚è§£</span>
<span class="token comment">//æ³¨ï¼šéšæœºæ•°ç”Ÿæˆå‡½æ•°çš„å¤´æ–‡ä»¶ï¼šcstdlibä¸ctime</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">random</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span>b<span class="token operator">-</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>a<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//æ±‚ax=b(mod p)çš„æœ€å°éè´Ÿè§£(æ‰©æ¬§)</span>
<span class="token keyword">struct</span> <span class="token class-name">One</span>
<span class="token punctuation">&#123;</span>
    ll a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>p<span class="token punctuation">,</span>x<span class="token punctuation">;</span>

    <span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token function">One</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll b<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> d<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> x<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> y<span class="token punctuation">)</span>  <span class="token comment">//æ‰©æ¬§ </span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> 
            <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ll d<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token punctuation">,</span>d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ax+py=b</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">%</span>d<span class="token punctuation">)</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//æ— è§£</span>
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            x<span class="token operator">*=</span>b<span class="token operator">/</span>d<span class="token punctuation">;</span> y<span class="token operator">*=</span>b<span class="token operator">/</span>d<span class="token punctuation">;</span>
            x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b <span class="token operator">>></span> p<span class="token punctuation">;</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No solution!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//æ±‚nå…³äºpçš„äºŒæ¬¡å‰©ä½™ï¼ˆå³æ±‚x^2=n(mod p)çš„è§£ï¼‰</span>
<span class="token comment">//è¯´æ˜ï¼šæ˜æ˜¾è§£ä¸ºä¸€ä¸ªå‰©ä½™ç±»ï¼ˆå³å¦‚æœæœ‰è§£åˆ™æœ‰æ— ç©·ä¸ªè§£ï¼‰</span>
<span class="token comment">//è‹¥xä¸ºè§£ï¼Œé‚£ä¹ˆx+mpä¹Ÿä¸ºè§£ï¼ŒåŒæ—¶å¾ˆæ˜¾ç„¶ï¼Œp-xä¹Ÿä¸ºè§£ï¼Œæ•…åŸºæœ¬è§£æœ‰ä¸¤ä¸ªï¼Œxå’Œp-x</span>

<span class="token comment">//äºŒæ¬¡åŸŸï¼ˆæœ‰ç†æ•°çš„äºŒæ¬¡æ‰©åŸŸï¼‰ç±»ï¼Œé‡è½½äº†ä¹˜å·å’Œå¿«é€Ÿå¹‚</span>
<span class="token keyword">struct</span> <span class="token class-name">QuadraticFild</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//wä¸ºæ— ç†æ•°åŸŸï¼Œxä¸ºæœ‰ç†æ•°åŸŸçš„å€¼ï¼Œyä¸ºæ— ç†æ•°åŸŸçš„å€¼ï¼Œpä¸ºæ¨¡æ•°</span>
    ll x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">;</span>
    <span class="token function">QuadraticFild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token function">QuadraticFild</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span>ll y<span class="token punctuation">,</span>ll w<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">w</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>

    <span class="token comment">//é‡è½½ä¹˜å·</span>
    QuadraticFild <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> QuadraticFild<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
        QuadraticFild ans<span class="token punctuation">;</span>
        ans<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>b<span class="token punctuation">.</span>x<span class="token operator">%</span>p <span class="token operator">+</span> y<span class="token operator">*</span>b<span class="token punctuation">.</span>y<span class="token operator">%</span>p<span class="token operator">*</span>w<span class="token operator">%</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
        ans<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>b<span class="token punctuation">.</span>y<span class="token operator">%</span>p <span class="token operator">+</span> y<span class="token operator">*</span>b<span class="token punctuation">.</span>x<span class="token operator">%</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token punctuation">;</span>
        <span class="token comment">//ä¸€å®šè¦å°†æ‰€æœ‰æˆå‘˜å˜é‡åˆå§‹åŒ–å®Œæ¯•åæ‰èƒ½è¿”å›ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span>
        ans<span class="token punctuation">.</span>w <span class="token operator">=</span> w<span class="token punctuation">;</span> ans<span class="token punctuation">.</span>p <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//é‡è½½å¿«é€Ÿå¹‚</span>
    QuadraticFild <span class="token keyword">operator</span> <span class="token operator">^</span> <span class="token punctuation">(</span>ll b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
        QuadraticFild <span class="token function">res</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> res <span class="token operator">*</span> a<span class="token punctuation">;</span>
            b<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> a<span class="token operator">*</span>a<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//æ±‚äºŒæ¬¡å‰©ä½™ç±»</span>
<span class="token keyword">struct</span> <span class="token class-name">Two</span>
<span class="token punctuation">&#123;</span>
    ll n<span class="token punctuation">,</span>p<span class="token punctuation">;</span>
    <span class="token function">Two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token function">Two</span><span class="token punctuation">(</span>ll n<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>
    
    ll <span class="token function">fastpow</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll b<span class="token punctuation">,</span>ll m<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ll res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> res <span class="token operator">*</span> a <span class="token operator">%</span> m<span class="token punctuation">;</span>
            b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> a <span class="token operator">*</span> a <span class="token operator">%</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//æ±‚å‹’è®©å¾·ç¬¦å·</span>
    ll <span class="token function">Legender</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        ll ans <span class="token operator">=</span> <span class="token function">fastpow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ans <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">bool</span> <span class="token function">solve</span><span class="token punctuation">(</span>ll<span class="token operator">&amp;</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ll a<span class="token punctuation">,</span>w<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//æ­¤æ—¶è§£å®Œå…¨å–å†³äºnï¼Œåªæœ‰0æˆ–1ä¸¤ä¸ªè§£</span>
            res <span class="token operator">=</span> n<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Legender</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//æ— è§£</span>
        <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//ä¸€ç›´éšæœºaç›´åˆ°ç”Ÿæˆçš„wä¸ºå¯¹pçš„éäºŒæ¬¡å‰©ä½™</span>
            a <span class="token operator">=</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            w <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token operator">%</span>p<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Legender</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        QuadraticFild <span class="token function">ans</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ans <span class="token operator">=</span> ans <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res <span class="token operator">=</span> ans<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> n <span class="token operator">>></span> p<span class="token punctuation">;</span>
        ll res1<span class="token punctuation">,</span>res2<span class="token punctuation">;</span>
        n<span class="token operator">%=</span>p<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">solve</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No solution!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        res2 <span class="token operator">=</span> p<span class="token operator">-</span>res1<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res1 <span class="token operator">></span> res2<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>res1<span class="token punctuation">,</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res1 <span class="token operator">==</span> res2<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> res1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout <span class="token operator">&lt;&lt;</span> res1 <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> res2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Two o<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/*
ONE:
0 1 11
No solution
3 5 11
9
3 -6 11
9
TWO:
0 11
0 11
1 11
1 10
5 11
4 7
10 11
No solution
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="ç»„åˆæ•°å­¦"><a href="#ç»„åˆæ•°å­¦" class="headerlink" title="ç»„åˆæ•°å­¦"></a>ç»„åˆæ•°å­¦</h2><h2 id="åšå¼ˆè®º"><a href="#åšå¼ˆè®º" class="headerlink" title="åšå¼ˆè®º"></a>åšå¼ˆè®º</h2><h1 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h1><h2 id="åŸºç¡€æ•°æ®ç»“æ„"><a href="#åŸºç¡€æ•°æ®ç»“æ„" class="headerlink" title="åŸºç¡€æ•°æ®ç»“æ„"></a>åŸºç¡€æ•°æ®ç»“æ„</h2><h3 id="æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ï¼‰"><a href="#æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ï¼‰" class="headerlink" title="æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ï¼‰"></a>æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP3368æ ‘çŠ¶æ•°ç»„æ¨¡æ¿2</span>
<span class="token comment">//åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">jud cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"caonima"</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pll pair<span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Clear</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>x<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>x<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pqg</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pql</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">lowbit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token comment">//æŠŠå·®åˆ†æ ‘çŠ¶æ•°ç»„ä½ç½®ä¸ºxçš„æ•°åŠ ä¸Šk</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token punctuation">;</span>
        x <span class="token operator">+=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ±‚å·®åˆ†æ ‘çŠ¶æ•°ç»„åŒºé—´1-xçš„å€¼</span>
<span class="token keyword">int</span> <span class="token function">getsum</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res <span class="token operator">+=</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y <span class="token operator">>></span> k<span class="token punctuation">;</span>
            d<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token punctuation">;</span> d<span class="token punctuation">[</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-=</span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">updata</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> x<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼‰"><a href="#æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼‰" class="headerlink" title="æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼‰"></a>æ ‘çŠ¶æ•°ç»„ï¼ˆå·®åˆ†æ ‘çŠ¶æ•°ç»„æ±‚åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//Poj3468æ ‘çŠ¶æ•°ç»„æ¨¡æ¿3</span>
<span class="token comment">//åŒºé—´ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">jud cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"caonima"</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pll pair<span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Clear</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>x<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>x<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pqg</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pql</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
ll a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c1<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> op<span class="token punctuation">;</span>

ll <span class="token function">lowbit</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token comment">//æŠŠ2ä¸ªå·®åˆ†æ ‘çŠ¶æ•°ç»„ä½ç½®ä¸ºxçš„æ•°åŠ ä¸Šk</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span>ll k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    ll xx <span class="token operator">=</span> x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//(x-1)*kä¸­çš„xæ˜¯ä¸å˜çš„</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        c1<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token punctuation">;</span>
        c2<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token operator">*</span>xx<span class="token punctuation">;</span>
        x <span class="token operator">+=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ±‚å·®åˆ†æ ‘çŠ¶æ•°ç»„åŒºé—´1-xçš„å€¼</span>
ll <span class="token function">getsum</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    ll res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> xx <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res <span class="token operator">+=</span> xx<span class="token operator">*</span>c1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">-</span>c2<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token string">'C'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            ll x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y <span class="token operator">>></span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">updata</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            ll x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢å•ç‚¹æŸ¥è¯¢ï¼‰"><a href="#æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢å•ç‚¹æŸ¥è¯¢ï¼‰" class="headerlink" title="æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢å•ç‚¹æŸ¥è¯¢ï¼‰"></a>æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢å•ç‚¹æŸ¥è¯¢ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP3374æ ‘çŠ¶æ•°ç»„æ¨¡æ¿1</span>
<span class="token comment">//å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´å•ç‚¹æŸ¥è¯¢</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">jud cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"caonima"</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pll pair<span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Clear</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>x<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>x<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pqg</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">pql</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> priority_queue<span class="token operator">&lt;</span>type<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span>type<span class="token operator">>></span></span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">lowbit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token comment">//åœ¨xä½ç½®çš„æ•°åŠ ä¸Šk</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token punctuation">;</span>
        x <span class="token operator">+=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ±‚åŒºé—´1-xä¹‹å’Œ</span>
<span class="token keyword">int</span> <span class="token function">getsum</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        res <span class="token operator">+=</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> k<span class="token punctuation">;</span>
            a<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="çº¿æ®µæ ‘ï¼ˆåŠ æ³•ï¼‰"><a href="#çº¿æ®µæ ‘ï¼ˆåŠ æ³•ï¼‰" class="headerlink" title="çº¿æ®µæ ‘ï¼ˆåŠ æ³•ï¼‰"></a>çº¿æ®µæ ‘ï¼ˆåŠ æ³•ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P3372çº¿æ®µæ ‘1</span>
<span class="token comment">//åŒºé—´åŠ ä¸æ±‚åŒºé—´å’Œ</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>op<span class="token punctuation">,</span>_root<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
ll k<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> l<span class="token punctuation">,</span>r<span class="token punctuation">,</span>lson<span class="token punctuation">,</span>rson<span class="token punctuation">;</span>
	ll ans<span class="token punctuation">,</span>tag<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">pushdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span> <span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> r<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+=</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+=</span> k<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

ll <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
	ll ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> ans <span class="token operator">+=</span> <span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> ans <span class="token operator">+=</span> <span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>op<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">updata</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
 	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="çº¿æ®µæ•°ï¼ˆåŠ ä¹˜æ³•ï¼‰"><a href="#çº¿æ®µæ•°ï¼ˆåŠ ä¹˜æ³•ï¼‰" class="headerlink" title="çº¿æ®µæ•°ï¼ˆåŠ ä¹˜æ³•ï¼‰"></a>çº¿æ®µæ•°ï¼ˆåŠ ä¹˜æ³•ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P3372çº¿æ®µæ ‘2</span>
<span class="token comment">//åŒºé—´åŠ ä¸åŒºé—´ä¹˜ä¸æ±‚åŒºé—´å’Œ</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>_root<span class="token punctuation">,</span>cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
ll p<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> l<span class="token punctuation">,</span>r<span class="token punctuation">,</span>lson<span class="token punctuation">,</span>rson<span class="token punctuation">;</span>
	ll ans<span class="token punctuation">,</span>tag1<span class="token punctuation">,</span>tag2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">pushdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token operator">-</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token operator">-</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> r<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">updata1</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">updata2</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">+</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
		tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">+</span>k<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata2</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata2</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

ll <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
	ll ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> ans <span class="token operator">=</span> <span class="token punctuation">(</span>ans<span class="token operator">+</span><span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> ans <span class="token operator">=</span> <span class="token punctuation">(</span>ans<span class="token operator">+</span><span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>op<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> op <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token function">updata2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
 	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ä¸»å¸­æ ‘ï¼ˆåŒºé—´ç¬¬kå°ï¼‰"><a href="#ä¸»å¸­æ ‘ï¼ˆåŒºé—´ç¬¬kå°ï¼‰" class="headerlink" title="ä¸»å¸­æ ‘ï¼ˆåŒºé—´ç¬¬kå°ï¼‰"></a>ä¸»å¸­æ ‘ï¼ˆåŒºé—´ç¬¬kå°ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P3834ä¸»å¸­æ ‘</span>
<span class="token comment">//åŒºé—´ç¬¬kå°</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">2e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">,</span>tot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> lson<span class="token punctuation">,</span>rson<span class="token punctuation">,</span>dat<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
set<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> se<span class="token punctuation">;</span>
map<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span> mp1<span class="token punctuation">,</span>mp2<span class="token punctuation">;</span> <span class="token comment">//mp1ç”±è¾“å…¥æ•°æ®æ˜ å°„è‡³ç¦»æ•£å€¼ï¼Œmp2ç›¸å</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root1<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root2<span class="token punctuation">,</span><span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	root2 <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>dat<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">;</span>
	tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token function">updata</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root1<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> mp2<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">-</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>dat<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;=</span> c<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		k<span class="token operator">-=</span>c<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token comment">//freopen("data.in","r",stdin);</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		se<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>se<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> mp1<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tot<span class="token punctuation">,</span> mp2<span class="token punctuation">[</span>tot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	_root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>mp1<span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
 	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P3375KMPæ¨¡æ¿</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>t<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> nex<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>slen<span class="token punctuation">,</span>tlen<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	nex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>tlen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//æ­£å¸¸æƒ…å†µåªéœ€è¦j&lt;tlen-1å³å¯</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token operator">++</span>j<span class="token punctuation">,</span> <span class="token operator">++</span>k<span class="token punctuation">;</span>
			nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">else</span> k <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//ç”¨äºåŠ å¿«åŒ¹é…é€Ÿåº¦çš„è¿›åŒ–ç‰ˆgetnext</span>
<span class="token keyword">void</span> <span class="token function">_getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	nex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>tlen<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token operator">++</span>j<span class="token punctuation">,</span> <span class="token operator">++</span>k<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">else</span> k <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	slen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> tlen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>slen<span class="token operator">&amp;&amp;</span>j<span class="token operator">&lt;</span>tlen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">==</span> tlen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>i<span class="token operator">-</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token operator">++</span>i<span class="token punctuation">,</span> <span class="token operator">++</span>j<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">else</span> j <span class="token operator">=</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>tlen<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	enl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s%s"</span><span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="acè‡ªåŠ¨æœº"><a href="#acè‡ªåŠ¨æœº" class="headerlink" title="acè‡ªåŠ¨æœº"></a>acè‡ªåŠ¨æœº</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·æ¨¡æ¿ACè‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆP3808ï¼ŒåŠ å¼ºç‰ˆP3796ï¼ŒäºŒæ¬¡åŠ å¼ºP5357)</span>
<span class="token comment">//ä¸‹é¢æ³¨é‡Šé™„æœ‰åŠ å¼ºç‰ˆåŠäºŒæ¬¡åŠ å¼ºç‰ˆ</span>
<span class="token comment">//ç®€å•ç‰ˆï¼šç»™å®šnä¸ªæ¨¡å¼ä¸²tå’Œä¸€ä¸ªæ–‡æœ¬ä¸²sï¼Œæ±‚æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸²é‡Œå‡ºç°è¿‡ã€‚ä¸¤ä¸ªæ¨¡å¼ä¸²ä¸åŒå½“ä¸”ä»…å½“ä»–ä»¬ç¼–å·ä¸åŒã€‚</span>
<span class="token comment">//åŠ å¼ºç‰ˆï¼šæœ‰nä¸ªç”±å°å†™å­—æ¯ç»„æˆçš„æ¨¡å¼ä¸²ä»¥åŠä¸€ä¸ªæ–‡æœ¬ä¸²sã€‚æ¯ä¸ªæ¨¡å¼ä¸²å¯èƒ½ä¼šåœ¨æ–‡æœ¬ä¸²ä¸­å‡ºç°å¤šæ¬¡ã€‚æ‰¾å‡ºå“ªäº›æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸²sä¸­å‡ºç°çš„æ¬¡æ•°æœ€å¤šã€‚ã€</span>
<span class="token comment">//äºŒæ¬¡åŠ å¼ºï¼šç»™ä½ ä¸€ä¸ªæ–‡æœ¬ä¸²så’Œnä¸ªæ¨¡å¼ä¸²t1...tnåˆ†åˆ«æ±‚å‡ºæ¯ä¸ªæ¨¡å¼ä¸²tiåœ¨sä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> son<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fail<span class="token punctuation">,</span>count<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>_rot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>

<span class="token comment">//æ’å…¥å‡½æ•°ï¼Œæ„å»ºtrieæ ‘</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>string str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> lotod <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span><span class="token punctuation">)</span> 
            tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
        now <span class="token operator">=</span> tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">++</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æ±‚èŠ‚ç‚¹çš„failæŒ‡é’ˆ</span>
<span class="token comment">//ç”»å›¾æ›´ä¸ºå¥½ç†è§£</span>
<span class="token keyword">void</span> <span class="token function">getfail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fail <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> now <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">//è‹¥ç¬¬iä¸ªå­—æ¯å­˜åœ¨ï¼Œåˆ™ç¬¬iä¸ªå­—æ¯failæŒ‡å‘&#123;çˆ¶äº²èŠ‚ç‚¹failæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹&#125;çš„ç¬¬iä¸ªå­—æ¯</span>
                <span class="token comment">//è‹¥è¯¥å­—æ¯æ²¡æœ‰ï¼Œåˆ™æŒ‡å‘çš„æ˜¯root</span>
                tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fail <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token comment">//ç¬¬iå­—æ¯ä¸å­˜åœ¨ï¼Œåˆ™nowçš„ç¬¬iä¸ªå„¿å­ï¼ˆå­—æ¯ï¼‰æŒ‡å‘&#123;çˆ¶äº²èŠ‚ç‚¹failæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹&#125;çš„ç¬¬iä¸ªå­—æ¯</span>
                tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//æŸ¥è¯¢åŒ¹é…å‡½æ•°</span>
<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        now <span class="token operator">=</span> tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>now<span class="token punctuation">;</span>j <span class="token operator">&amp;&amp;</span> tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">=</span>tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//ä¸€ç›´æ‰¾å¯»å½“å‰èŠ‚ç‚¹çš„failï¼Œç›´åˆ°å›åˆ°rootæˆ–è€…å·²ç»è¢«è®¿é—®è¿‡äº†</span>
            <span class="token comment">//è¿™èˆ¬æ“ä½œçš„æœ€ç»ˆç»“æœä¼šä½¿trieæ¯ä¸ªèŠ‚ç‚¹æ­£å¥½è®¿é—®ä¸€æ¬¡</span>
            ans <span class="token operator">+=</span> tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">;</span>
            tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        string str<span class="token punctuation">;</span>
        cin <span class="token operator">>></span> str<span class="token punctuation">;</span>
        <span class="token function">insert</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    cin <span class="token operator">>></span> s<span class="token punctuation">;</span>
    <span class="token function">getfail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">query</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token operator">*</span>enl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/*

*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="é«˜çº§æ•°æ®ç»“æ„"><a href="#é«˜çº§æ•°æ®ç»“æ„" class="headerlink" title="é«˜çº§æ•°æ®ç»“æ„"></a>é«˜çº§æ•°æ®ç»“æ„</h2><h1 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h1><h2 id="æœ€çŸ­è·¯"><a href="#æœ€çŸ­è·¯" class="headerlink" title="æœ€çŸ­è·¯"></a>æœ€çŸ­è·¯</h2><h3 id="ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–dijkstra"><a href="#ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–dijkstra" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–dijkstra"></a>ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–dijkstra</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP4779å•æºæœ€çŸ­è·¯æ¨¡æ¿</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep0</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Edge</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Dijkstra</span>
<span class="token punctuation">&#123;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//pæ•°ç»„æ¥å­˜å‚¨æœ€çŸ­è·¯è·¯å¾„ï¼Œsæ˜¯èµ·ç‚¹ï¼Œp[i]è¡¨ç¤ºiç»“ç‚¹çš„ä¸Šä¸€ä¸ªç»“ç‚¹æ‰€è¿çš„è¾¹ï¼ˆæ³¨æ„ï¼Œpä¸­å­˜çš„æ˜¯è¾¹çš„ç¼–å·ï¼ï¼‰</span>
    <span class="token keyword">int</span> p<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>

    <span class="token function">Dijkstra</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//å †ä¼˜åŒ–ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼Œpii.firstå­˜å‚¨då€¼ï¼Œpii.secondå­˜å‚¨ç»“ç‚¹ç¼–å·</span>
        priority_queue<span class="token operator">&lt;</span>pii <span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>pii <span class="token operator">></span> <span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>pii <span class="token operator">></span> <span class="token operator">></span> q<span class="token punctuation">;</span>
        <span class="token comment">//åˆå§‹åŒ–då€¼</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            pii d <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> d<span class="token punctuation">.</span>second<span class="token punctuation">;</span>
            <span class="token comment">//å¦‚æœå‡ºæ¥çš„piiï¼Œdå€¼ä¸ç­‰äºdisæ•°ç»„é‡Œçš„æ•°ï¼Œé‚£ä¹ˆè¯´æ˜å®ƒè¢«æ¾å¼›äº†ä¸¤æ¬¡ï¼Œæ˜¾ç„¶å‰é¢å‡ºç°çš„é‚£ä¸ªæ›´å¥½ï¼Œ</span>
            <span class="token comment">//æ‰€ä»¥æ˜¾ç„¶è¢«è®¿é—®è¿‡äº†ï¼Œçœæ‰äº†visè®¿é—®æ ‡è®°æ•°ç»„</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>first <span class="token operator">!=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                    p<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">==</span>n<span class="token operator">?</span><span class="token string">'\n'</span><span class="token operator">:</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Dijkstra <span class="token function">dj</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dj<span class="token punctuation">.</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dj<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="spfa"><a href="#spfa" class="headerlink" title="spfa"></a>spfa</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP4779å•æºæœ€çŸ­è·¯æ¨¡æ¿</span>
<span class="token comment">//SPFA</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep0</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token comment">//const int maxn = 1e5+3;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Edge</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">SPFA</span>
<span class="token punctuation">&#123;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//SPFAåˆ¤æ–­è´Ÿç¯çš„æ ¸å¿ƒï¼Œå¦‚æœä¸€ä¸ªç»“ç‚¹å…¥é˜Ÿæ¬¡æ•°å¤§äºç­‰äºnï¼Œåˆ™è¡¨æ˜å­˜åœ¨è´Ÿç¯</span>
    <span class="token comment">//å› ä¸ºåœ¨Bellman-fordä¸­æ•´ä¸ªå›¾åªéœ€è¦æ¾å¼›n-1æ¬¡å°±å¯ä»¥æ‰¾åˆ°æœ€çŸ­è·¯äº†</span>
    <span class="token keyword">int</span> cnt<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//pæ•°ç»„æ¥å­˜å‚¨æœ€çŸ­è·¯è·¯å¾„ï¼Œsæ˜¯èµ·ç‚¹ï¼Œp[i]è¡¨ç¤ºiç»“ç‚¹çš„ä¸Šä¸€ä¸ªç»“ç‚¹æ‰€è¿çš„è¾¹ï¼ˆæ³¨æ„ï¼Œpä¸­å­˜çš„æ˜¯è¾¹çš„ç¼–å·ï¼ï¼‰</span>
    <span class="token keyword">int</span> p<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token comment">//åˆ¤æ–­ç»“ç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­</span>
    <span class="token keyword">bool</span> inq<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">bool</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
        inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                    p<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">++</span>cnt<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ERROR!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">==</span>n<span class="token operator">?</span><span class="token string">'\n'</span><span class="token operator">:</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    SPFA <span class="token function">sp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sp<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="floyd"><a href="#floyd" class="headerlink" title="floyd"></a>floyd</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP4779å•æºæœ€çŸ­è·¯æ¨¡æ¿</span>
<span class="token comment">//SPFA</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep0</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token comment">//const int maxn = 1e3+3;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e2</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Floyd</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//é‚»æ¥çŸ©é˜µå­˜è¾¹</span>
    <span class="token keyword">int</span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>

    <span class="token function">Floyd</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>j<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>

        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> inf <span class="token operator">&amp;&amp;</span> G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> inf<span class="token punctuation">)</span>
                        G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Floyd <span class="token function">fl</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fl<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//P3379æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰</span>
<span class="token comment">//tarjanç¦»çº¿ç®—æ³•</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">judge cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"caonima"</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">,</span>f<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>pii <span class="token operator">></span> qe<span class="token punctuation">;</span>   <span class="token comment">//firstä¸ºæƒå€¼ï¼ˆå³ç­”æ¡ˆï¼‰ï¼Œsecondä¸ºè¯¥è¾¹çš„ç›®æ ‡ç‚¹</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> quer<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tr<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">getf</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">==</span>v<span class="token operator">?</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">:</span><span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">lca</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">lca</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>quer<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> e <span class="token operator">=</span> quer<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">)</span>
            qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> qe<span class="token punctuation">[</span>e<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//eä¸e^1äº’ä¸ºåå‘è¾¹</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//freopen("data.in","r",stdin);</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> s<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> tr<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        qe<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> qe<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quer<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>qe<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quer<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>qe<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token function">lca</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        cout <span class="token operator">&lt;&lt;</span> qe<span class="token punctuation">[</span>i<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="å¼ºè¿é€šåˆ†é‡"><a href="#å¼ºè¿é€šåˆ†é‡" class="headerlink" title="å¼ºè¿é€šåˆ†é‡"></a>å¼ºè¿é€šåˆ†é‡</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P2002æ¶ˆæ¯æ‰©æ•£</span>
<span class="token comment">//æœ‰nä¸ªåŸå¸‚ï¼Œä¸­é—´æœ‰å•å‘é“è·¯è¿æ¥ï¼Œæ¶ˆæ¯ä¼šæ²¿ç€é“è·¯æ‰©æ•£ï¼Œç°åœ¨ç»™å‡ºnä¸ªåŸå¸‚åŠå…¶ä¹‹é—´çš„é“è·¯ï¼Œ</span>
<span class="token comment">//é—®è‡³å°‘éœ€è¦åœ¨å‡ ä¸ªåŸå¸‚å‘å¸ƒæ¶ˆæ¯æ‰èƒ½è®©è¿™æ‰€æœ‰nä¸ªåŸå¸‚éƒ½å¾—åˆ°æ¶ˆæ¯ã€‚</span>
<span class="token comment">//æ±‚å‡ºå¼ºè¿é€šåˆ†é‡å¹¶æŸ“è‰²ï¼Œç¼©ç‚¹ï¼Œç„¶åéå†æ‰€æœ‰è¾¹æ±‚æ¯ä¸ªç‚¹å…¥åº¦ï¼Œç­”æ¡ˆä¸ºå…¥åº¦ä¸º0çš„ç‚¹çš„ä¸ªæ•°</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxm <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">//é‚»æ¥è¡¨å­˜å›¾ï¼Œ&lt;dfn[i],low[i]>ï¼ŒèŠ‚ç‚¹çš„å®é™…è®¿é—®æ—¶é—´æˆ³å’Œæœ€æ—©èƒ½å›æº¯åˆ°çš„æ—¶é—´æˆ³</span>
<span class="token comment">//coloræ•°ç»„ç»™æ¯ä¸ªå¼ºè¿é€šåˆ†é‡æŸ“è‰²ï¼Œinsæ ‡è®°æ•°ç»„æ ‡è®°æ˜¯å¦åœ¨æ ˆä¸­</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>fir<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>from<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">,</span>to<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dfn<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tim <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>color<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>colortot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
stack<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> s<span class="token punctuation">;</span>
<span class="token keyword">int</span> indeg<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">intit</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>fir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>
		cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">!=</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			to<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
			from<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
			nex<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>
			fir<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> nod<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span> ins<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tim<span class="token punctuation">;</span>  <span class="token comment">//æ›´æ–°è¯¥èŠ‚ç‚¹æ—¶é—´æˆ³</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>fir<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">=</span>nex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¯¹äº1->2->3->1è¿™ä¸ªç¯å›¾</span>
		<span class="token comment">//ç¬¬ä¸€ä¸ªifæƒ…å†µä¸ºï¼Œnod=1ï¼Œto[i]=2</span>
		<span class="token comment">//ç¬¬äºŒä¸ªifæƒ…å†µä¸ºï¼Œnod=3ï¼Œto[i]=1</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//å¦‚æœç›®æ ‡èŠ‚ç‚¹æœªè¢«è®¿é—®</span>
			<span class="token function">dfs</span><span class="token punctuation">(</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ins<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">//å¦‚æœç›®æ ‡èŠ‚ç‚¹è¿˜åœ¨æ ˆä¸­</span>
			low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">==</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token operator">++</span>colortot<span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> temp <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ins<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			color<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> colortot<span class="token punctuation">;</span>  <span class="token comment">//æŸ“è‰²</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">==</span> nod<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> 
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//å¯¹æ‰€æœ‰è¾¹æ“ä½œï¼Œæ±‚æ¯ä¸ªå¼ºè¿é€šåˆ†é‡çš„å…¥åº¦</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>cnt<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span>from<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">!=</span> color<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token operator">++</span>indeg<span class="token punctuation">[</span>color<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>colortot<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>indeg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">++</span>res<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
	<span class="token function">intit</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="å›¾çš„å‰²ç‚¹ä¸æ¡¥"><a href="#å›¾çš„å‰²ç‚¹ä¸æ¡¥" class="headerlink" title="å›¾çš„å‰²ç‚¹ä¸æ¡¥"></a>å›¾çš„å‰²ç‚¹ä¸æ¡¥</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ´›è°·P3388å‰²ç‚¹ï¼ˆå‰²é¡¶ï¼‰æ¨¡æ¿ï¼šnä¸ªç‚¹mæ¡è¾¹æ— å‘å›¾çš„å‰²ç‚¹</span>
<span class="token comment">//å¯¹äºä¸€ä¸ªdfsæ ‘ï¼š</span>
<span class="token comment">//xæ˜¯å‰²ç‚¹ï¼š1.xä¸ºérootç‚¹&amp;&amp;æœ‰å„¿å­&amp;&amp;low[xçš„å„¿å­]>=dfn[x]   2.xä¸ºrootç‚¹&amp;&amp;è‡³å°‘æœ‰2ä¸ªå„¿å­</span>
<span class="token comment">//x->yæ˜¯æ¡¥ï¼šlow[y]>dfn[x]</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl <span class="token function">puts</span><span class="token punctuation">(</span></span><span class="token string">""</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">2e4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxm <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">//é‚»æ¥è¡¨å­˜å›¾ï¼Œ&lt;dfn[i],low[i]>ï¼ŒèŠ‚ç‚¹çš„å®é™…è®¿é—®æ—¶é—´æˆ³å’Œæœ€è¿‘èƒ½å›æº¯åˆ°çš„æ—¶é—´æˆ³ï¼ˆä¸å¼ºè¿é€šåˆ†é‡â€œæœ€æ—©â€æœ‰åŒºåˆ«ï¼‰</span>
<span class="token comment">//è¿™é‡Œçš„è¾¹ä»0å¼€å§‹å­˜å‚¨ï¼Œè¿™æ ·å½“è¾¹ä¸ºeæ—¶å¯¹åº”çš„åå‘è¾¹ä¸ºe^1</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>fir<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>from<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>to<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dfn<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tim <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>fa<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> incutver<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>incutedg<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> cutver<span class="token punctuation">,</span>cutedg<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> nod<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tim<span class="token punctuation">;</span>
	<span class="token keyword">int</span> sontot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>fir<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">=</span>nex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			fa<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> nod<span class="token punctuation">;</span> <span class="token function">dfs</span><span class="token punctuation">(</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token operator">++</span>sontot<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>sontot<span class="token operator">>=</span><span class="token number">2</span> <span class="token operator">||</span> fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>sontot<span class="token operator">&amp;&amp;</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">>=</span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>incutver<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span>
					cutver<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">,</span> incutver<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">></span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>incutedg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> 
				cutedg<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> incutedg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> incutedg<span class="token punctuation">[</span>i<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span> low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">!=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span> dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¿™é‡Œä¸å¼ºè¿é€šåˆ†é‡ä¸åŒï¼Œä¸èƒ½å›æº¯å¤ªè¿œï¼Œå¦åˆ™å‰²ç‚¹ä¼šå°‘</span>
		<span class="token comment">//å‚è€ƒæ ·ä¾‹ï¼š5 6 1 2 2 3 3 4 4 5 1 3 3 5</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">*</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sort</span><span class="token punctuation">(</span>cutver<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cutver<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> cutver<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> u<span class="token operator">:</span> cutver<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> u <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	enl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>fir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
		cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
		nex<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span> fir<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span> to<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">;</span>
		nex<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span> fir<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span> to<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="äºŒåˆ†å›¾"><a href="#äºŒåˆ†å›¾" class="headerlink" title="äºŒåˆ†å›¾"></a>äºŒåˆ†å›¾</h2><h3 id="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ï¼‰"><a href="#äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ï¼‰" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ï¼‰"></a>äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//P3386äºŒåˆ†å›¾æœ€å¤§åŒ¹é…æ¨¡æ¿</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">enl cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"\n"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pdd pair<span class="token operator">&lt;</span><span class="token keyword">double</span> <span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pss pair<span class="token operator">&lt;</span>string <span class="token punctuation">,</span> string <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">503</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>mat<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>used<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>res<span class="token punctuation">;</span>

<span class="token keyword">bool</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>used<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            used<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">Find</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">ONLINE_JUDGE</span></span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"data.in"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
	ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> e<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>e<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>used<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>used<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Find</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">++</span>res<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="ç½‘ç»œæµ"><a href="#ç½‘ç»œæµ" class="headerlink" title="ç½‘ç»œæµ"></a>ç½‘ç»œæµ</h2><h3 id="ç½‘ç»œæµæœ€å¤§æµï¼ˆä¼˜åŒ–dinicï¼‰"><a href="#ç½‘ç»œæµæœ€å¤§æµï¼ˆä¼˜åŒ–dinicï¼‰" class="headerlink" title="ç½‘ç»œæµæœ€å¤§æµï¼ˆä¼˜åŒ–dinicï¼‰"></a>ç½‘ç»œæµæœ€å¤§æµï¼ˆä¼˜åŒ–dinicï¼‰</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//åŸå‹é¢˜ä¸ºluoguP1343</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep0</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">203</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Edge</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">cap</span><span class="token punctuation">(</span>cap<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">NetworkFlow</span>
<span class="token punctuation">&#123;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
    <span class="token keyword">int</span> cur<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//nä¸ªç‚¹ï¼Œmæ¡è¾¹ï¼Œç½‘ç»œæµæœ€å¤§æµä¸ºMaxFlowï¼Œéœ€è¦é€çš„æµé‡ä¸ºx</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span>MaxFlow<span class="token punctuation">;</span>

    <span class="token function">NetworkFlow</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> MaxFlow<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MaxFlow</span><span class="token punctuation">(</span>MaxFlow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">addEdge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">addEdge</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">addEdge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        G<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">bool</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//æ±‚ä»æºç‚¹åˆ°æ±‡ç‚¹æ˜¯å¦å­˜åœ¨å¢å¹¿è·¯</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
        <span class="token comment">//ä»æºç‚¹ä¸º1å¼€å§‹æ‰¾</span>
        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">//å¦‚æœè¦å»çš„ç‚¹å·²ç»è¢«è®¿é—®è¿‡ï¼Œæˆ–è€…è¯¥è¾¹çš„æ®‹é‡å·²ç»ä¸å¤Ÿï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦èµ°è¿™æ¡è·¯äº†</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> dis<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//ä»èŠ‚ç‚¹uå‡ºå‘æ®‹é‡ä¸ºflowæ—¶çš„æœ€å¤§å¢é‡</span>
    <span class="token comment">//åœ¨uè¿™ä¸ªèŠ‚ç‚¹ï¼Œæ‰€æ‹¥æœ‰çš„æµé‡ä¸ºflowï¼Œè¿”å›å€¼æ˜¯ä»uå‡ºå‘èƒ½å¤Ÿè¾“é€çš„æœ€å¤§æµé‡</span>
    <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> flow<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
        <span class="token comment">//ç”¨ä¸€ä¸ªå˜é‡detlaå­˜æ®‹é‡</span>
        <span class="token keyword">int</span> detla <span class="token operator">=</span> flow<span class="token punctuation">;</span>

        <span class="token comment">//ä»cur[u]å¼€å§‹æ‰¾è¾¹ï¼Œå› ä¸ºå‰é¢çš„è¾¹å·²ç»ç”¨å®Œäº†</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>cur<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">//è¿™ä¸€æ¡è¾¹å·²ç»è¢«ç”¨å®Œäº†</span>
            <span class="token operator">++</span>cur<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//å¦‚æœe.toå¯ä»¥èµ°</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>detla<span class="token punctuation">,</span>e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//ä¿®æ”¹è¾¹ä¸åå‘è¾¹çš„å®¹é‡</span>
                edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">-=</span>d<span class="token punctuation">;</span>
                edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">+=</span>d<span class="token punctuation">;</span>
                detla<span class="token operator">-=</span>d<span class="token punctuation">;</span>
                <span class="token comment">//å¦‚æœè¯¥èŠ‚ç‚¹çš„æ®‹é‡å·²ç»è¢«ç”¨å®Œäº†ï¼Œåˆ™é€€å‡ºå¾ªç¯</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>detla <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> flow <span class="token operator">-</span> detla<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//è§£å†³å‡½æ•°</span>
    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            MaxFlow<span class="token operator">+=</span><span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>MaxFlow<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Orz Ni Jinan Saint Cow!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">%</span>MaxFlow<span class="token punctuation">)</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span>MaxFlow<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token operator">-</span>x<span class="token operator">%</span>MaxFlow<span class="token punctuation">)</span><span class="token operator">/</span>MaxFlow<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span>MaxFlow<span class="token punctuation">,</span>x<span class="token operator">/</span>MaxFlow<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    NetworkFlow <span class="token function">nf</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nf<span class="token punctuation">.</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æœ€å°è´¹ç”¨æœ€å¤§æµ"><a href="#æœ€å°è´¹ç”¨æœ€å¤§æµ" class="headerlink" title="æœ€å°è´¹ç”¨æœ€å¤§æµ"></a>æœ€å°è´¹ç”¨æœ€å¤§æµ</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//luoguP3381æœ€å°è´¹ç”¨æœ€å¤§æµæ¨¡æ¿</span>
<span class="token comment">//dinic+spfa</span>
<span class="token comment">//æ€è·¯ï¼š</span>
<span class="token comment">//å…ˆä»¥æœ€å°èŠ±è´¹æ±‚å‡ºæœ€çŸ­è·¯ï¼Œç„¶åå¾€æœ€çŸ­è·¯ä¸ŠåŠ æµé‡ï¼Œå¯ä»¥æ±‚å‡ºåœ¨æœ€çŸ­è·¯ä¸Šå¯åŠ çš„æœ€å¤§æµé‡</span>
<span class="token comment">//spfaæ±‚dis[t]ï¼Œdfsæ±‚æœ€çŸ­è·¯ä¸Šçš„æœ€å¤§æµï¼Œé‚£ä¹ˆæœ€å°èŠ±è´¹ä¸ºdis[t]*maxflowï¼Œå¦‚æœæœ‰å¤šæ¡æœ€çŸ­è·¯åŒæ—¶å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥è¯æ˜æ­¤å¼æˆç«‹</span>
<span class="token comment">//è¿™é‡Œæ³¨æ„è¦ç”¨ä¸€ä¸ªvisåœ¨dfsä¸­æ ‡è®°ç»“ç‚¹ï¼Œä¿è¯æ¯ä¸ªç‚¹åªèƒ½dfsä¸€æ¬¡ï¼ˆä¸æœ€å¤§æµæ¨¡æ¿æœ‰äº›ä¸åŒï¼‰</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep0</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">rep1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pii pair<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">pb push_back</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//æœ€å¤§æµå’Œæœ€å°è´¹ç”¨ä¿è¯åœ¨2^31-1å†…ï¼Œè¿™æ—¶å€™ç®—æ³•ä¸­æ³¨æ„å¤„ç†æº¢å‡ºæƒ…å†µ</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x7fffffff</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">,</span>minfee<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>maxflow<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Edge</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">cap</span><span class="token punctuation">(</span>cap<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> inq<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//spfaæ±‚æœ€çŸ­è·¯å¾„</span>
<span class="token comment">//æ±‚å‡ºæ¥çš„è·¯å¾„ç”¨disä¸è¾¹æƒåšæ¯”è¾ƒæ¥ç¡®è®¤è·¯å¾„ï¼Œæ‰€ä»¥æ±‚å‡ºæ¥çš„è·¯å¾„ä¸ä¸€å®šæ˜¯ä¸€æ¡å•ä¸€çš„è·¯å¾„ï¼Œ</span>
<span class="token comment">//æœ‰å¯èƒ½ä¸ºå¤šæ¡è·¯å¾„ï¼Œç„¶åå†ä¸Šé¢åŠ æµé‡ï¼ˆå¢å¹¿ï¼‰</span>
<span class="token keyword">bool</span> <span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>inq<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
    inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        inq<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//é¦–å…ˆè¦ä¿è¯è¿™æ˜¯ä¸€ä¸ªå¯ä»¥é€šæµé‡çš„æ­£è¾¹</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap<span class="token operator">></span><span class="token number">0</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span>inf<span class="token operator">||</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">></span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">++</span>cnt<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//è¿™é‡Œä¸èƒ½è¿”å›trueï¼Œå› ä¸ºspfaå¦‚æœä¸å­˜åœ¨è´Ÿç¯ï¼Œé‚£ä¹ˆä¹Ÿæœ‰å¯èƒ½æ— æ³•åˆ°è¾¾ç»ˆç‚¹ï¼Œ</span>
    <span class="token comment">//å› ä¸ºåˆ¤æ–­æ¡ä»¶ä¸ºæœ‰æµé‡æ—¶è¿™æ¡è·¯æ‰èƒ½èµ°</span>
    <span class="token keyword">return</span> dis<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">!=</span>inf<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//å‘æœ€çŸ­è·¯å¾„æ·»åŠ æµé‡ï¼Œæ— curä¼˜åŒ–ï¼ˆä¸å¤ªä¸€æ ·ï¼‰</span>
<span class="token comment">//ä¸ºäº†ä¿è¯æ¯ä¸€ä¸ªç‚¹åªèƒ½dfsä¸€æ¬¡ï¼ŒåŠ å…¥vis</span>
<span class="token comment">//å¦‚æœä¸ä½¿ç”¨visçš„è¯ï¼Œä¼šæœ‰å¯èƒ½å†ä¸¤ä¸ªç‚¹ä¹‹é—´æ¥å›dfsï¼ˆæµé‡éƒ½ä¸ä¸º0ï¼ŒåŒæ—¶ç”±äºåå‘è¾¹èŠ±è´¹ç›¸åçš„æƒ…å†µä¸‹å‡ºç°è¿™ç§æƒ…å†µï¼‰</span>
<span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> flow<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> t<span class="token punctuation">)</span> <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
    vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> detla <span class="token operator">=</span> flow<span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//æ‰¾åˆ°æœ€çŸ­è·¯å¾„</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap<span class="token operator">&amp;&amp;</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>detla<span class="token punctuation">,</span>e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">-=</span>d<span class="token punctuation">;</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">+=</span>d<span class="token punctuation">;</span>
            detla <span class="token operator">-=</span> d<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>detla <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">return</span> flow <span class="token operator">-</span> detla<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">addEdge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">,</span>wei<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    G<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>vis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        maxflow <span class="token operator">+=</span> d<span class="token punctuation">;</span>
        minfee <span class="token operator">+=</span> d<span class="token operator">*</span>dis<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span>maxflow<span class="token punctuation">,</span>minfee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//å‡ºç‚¹ï¼Œå…¥ç‚¹ï¼Œæµé‡é™åˆ¶ï¼Œæœ€å°è´¹ç”¨</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addEdge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addEdge</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h1></div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>lingxin</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/" title="æ¨¡æ¿">https://lingxin12.github.io.git/2021/03/21/%E6%A8%A1%E6%9D%BF/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/04/12/vpn%E6%90%AD%E5%BB%BA/" rel="prev" title="vpnæ­å»º"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">vpnæ­å»º</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/15/%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86%E5%8F%8A%E6%AC%A7%E6%8B%89%E7%AD%9B/" rel="next" title="æ¬§æ‹‰å®šç†åŠæ¬§æ‹‰ç­›"><span class="post-nav-text">æ¬§æ‹‰å®šç†åŠæ¬§æ‹‰ç­›</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è¦ä¸è¦å’Œæˆ‘è¯´äº›ä»€ä¹ˆï¼Ÿ</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> lingxin</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.2.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.5.2</span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#ECB3FF" stroke-width="2" stroke-linecap="round"></circle></svg></a><div id="aplayer"></div><script>window.addEventListener("DOMContentLoaded", () => {
  const ap = new APlayer({
    container: document.getElementById('aplayer'),
    fixed: true,
    autoplay: false,
    theme: "#ECB3FF",
    loop: "all",
    order: "list",
    preload: "auto",
    audio: [{"name":"åº­åœ’ã«ã¦","artist":"acane_madder","url":"/music/bgm.mp3","cover":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/bg/stars-timing-0.jpg"}],
    volume: 0.7,
    mutex: true,
    lrcType: 0,
    listFolded: false,
    listMaxHeight: "340px",
    storageName: "aplayer-setting"
  });
});</script></div></body></html>